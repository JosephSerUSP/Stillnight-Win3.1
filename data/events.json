[
  {
    "id": "stairs",
    "type": "stairs",
    "symbol": "S",
    "cssClass": "tile-stairs",
    "trigger": "touch",
    "actions": [{ "type": "DESCEND" }]
  },
  {
    "id": "recovery",
    "type": "recovery",
    "symbol": "R",
    "cssClass": "tile-recovery",
    "trigger": "touch",
    "actions": [{ "type": "HEAL_PARTY" }]
  },
  {
    "id": "enemy",
    "type": "enemy",
    "symbol": "E",
    "cssClass": "tile-enemy",
    "trigger": "touch",
    "actions": [{ "type": "BATTLE" }]
  },
  {
    "id": "shrine",
    "type": "shrine",
    "symbol": "♱",
    "cssClass": "tile-shrine",
    "trigger": "touch",
    "actions": [{ "type": "SHRINE" }]
  },
  {
    "id": "shop",
    "type": "shop",
    "symbol": "¥",
    "cssClass": "tile-shop",
    "trigger": "touch",
    "actions": [{ "type": "SHOP" }]
  },
  {
    "id": "recruit",
    "type": "recruit",
    "symbol": "U",
    "cssClass": "tile-recruit",
    "trigger": "touch",
    "actions": [{ "type": "RECRUIT" }]
  },
  {
    "id": "npc",
    "type": "npc",
    "symbol": "N",
    "cssClass": "tile-npc",
    "trigger": "touch",
    "actions": [{ "type": "NPC_DIALOGUE" }]
  },
  {
    "id": "trap",
    "type": "trap",
    "symbol": "T",
    "cssClass": "tile-trap",
    "trigger": "touch",
    "hidden": true,
    "trapValue": 5,
    "actions": [{ "type": "TRAP_TRIGGER", "damage": 5, "message": "You triggered a spike trap!" }]
  },
  {
    "id": "treasure",
    "type": "treasure",
    "symbol": "$",
    "cssClass": "tile-treasure",
    "trigger": "touch",
    "actions": [{ "type": "TREASURE" }]
  },
  {
    "id": "stranger",
    "type": "npc",
    "symbol": "!",
    "cssClass": "tile-npc",
    "trigger": "touch",
    "actions": [
      {
        "type": "SEQUENCE",
        "commands": [
          { "type": "CHECK_FLAG", "key": "MET_STRANGER", "value": true,
            "then": [
              { "type": "TEXT", "speaker": "Stranger", "text": "We have already spoken. Go forth." }
            ],
            "else": [
              { "type": "TEXT", "text": "You see a hooded figure standing in the shadows.", "image": "default.png" },
              { "type": "WAIT", "ms": 500 },
              { "type": "MOVE_EVENT", "eventId": "this", "dx": 0, "dy": 0 },
              { "type": "TEXT", "speaker": "Stranger", "text": "Halt. You are not from here, are you?" },
              { "type": "CHOICE", "choices": [
                  { "label": "Who are you?", "jumpTo": "INTRO" },
                  { "label": "Ignore", "jumpTo": "IGNORE" }
                ]
              },
              { "label": "INTRO" },
              { "type": "TEXT", "speaker": "Stranger", "text": "I am a watcher. Take this, it may help you." },
              { "type": "GIVE_ITEM", "itemId": "potion" },
              { "type": "SET_FLAG", "key": "MET_STRANGER", "value": true },
              { "type": "TEXT", "text": "The stranger hands you a potion and steps back into the shadows." },
              { "type": "MOVE_EVENT", "eventId": "this", "x": 0, "y": 0 },
              { "type": "CLOSE_WINDOW" },
              { "type": "REMOVE_EVENT", "eventId": "this" },
              { "label": "IGNORE" },
              { "type": "TEXT", "text": "You decide to walk away." },
              { "type": "CLOSE_WINDOW" }
            ]
          }
        ]
      }
    ]
  },
  {
    "id": "shrine_shade",
    "type": "shrine_scenario",
    "title": "Whispering Shade",
    "description": "A whisper from beyond promises knowledge... at a price.",
    "choices": [
      {
        "label": "Offer HP (lose 3 HP each, gain XP)",
        "effect": { "type": "multi", "effects": [
          { "type": "hp", "value": -3, "target": "all" },
          { "type": "xp", "value": 4, "target": "all" }
        ]}
      },
      {
        "label": "Decline",
        "effect": { "type": "message", "value": "[Shrine] You ignore the whispers." }
      }
    ]
  },
  {
    "id": "shrine_idol",
    "type": "shrine_scenario",
    "title": "Gleaming Idol",
    "description": "A gleaming idol stands before you, radiating warmth. Touching it could imbue power or curse you.",
    "choices": [
      {
        "label": "Touch the idol",
        "effect": { "type": "random", "outcomes": [
          { "chance": 0.5, "effect": { "type": "maxHp", "value": 2, "target": "all" } },
          { "chance": 0.5, "effect": { "type": "hp", "value": -2, "target": "all" } }
        ]}
      },
      {
        "label": "Walk away",
        "effect": { "type": "message", "value": "[Shrine] You leave the idol untouched." }
      }
    ]
  },
  {
    "id": "shrine_spirit",
    "type": "shrine_scenario",
    "title": "Bargaining Spirit",
    "description": "A translucent merchant appears, offering to trade gold for knowledge.",
    "choices": [
      {
        "label": "Pay 5G for knowledge",
        "effect": { "type": "gold", "value": -5, "onSuccess": { "type": "xp", "value": 6, "target": "all" } }
      },
      {
        "label": "Attempt to bargain",
        "effect": { "type": "random", "outcomes": [
          { "chance": 0.5, "effect": { "type": "xp", "value": 4, "target": "all" } },
          { "chance": 0.5, "effect": { "type": "gold", "value": -2 } }
        ]}
      },
      {
        "label": "Leave",
        "effect": { "type": "message", "value": "[Shrine] You refuse the deal." }
      }
    ]
  },
  {
    "id": "shrine_haste",
    "type": "shrine_scenario",
    "title": "Trial of Haste",
    "description": "A spectral stopwatch hovers in the air, its ticking echoing in your mind. It offers a challenge: a trial of speed for a reward.",
    "choices": [
      {
        "label": "Accept the trial (high risk, high reward)",
        "effect": { "type": "random", "outcomes": [
          { "chance": 0.4, "effect": { "type": "xp", "value": 15, "target": "all" } },
          { "chance": 0.6, "effect": { "type": "hp", "value": -5, "target": "all" } }
        ]}
      },
      {
        "label": "Take a small reward instead",
        "effect": { "type": "gold", "value": 10 }
      }
    ]
  }
]
