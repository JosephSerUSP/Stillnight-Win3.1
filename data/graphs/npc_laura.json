{
  "id": "npc_laura",
  "name": "Laura",
  "layout": "visual_novel",
  "portrait": "NPC_Laura",
  "initialNode": "root_router",
  "nodes": {
    "root_router": {
      "type": "ROUTER",
      "condition": "flag:laura_first_met",
      "trueNode": "default_text",
      "falseNode": "intro_text"
    },
    "intro_text": {
      "type": "TEXT",
      "speaker": "Laura",
      "content": "Well, hello there. New face. You look like someone who knows when to leave before things get ugly. That’s rare in this town. I’m Laura.",
      "next": "intro_choices"
    },
    "intro_choices": {
      "type": "CHOICE",
      "options": [
        { "label": "Browse Accessories", "target": "open_shop", "setFlag": "laura_first_met" },
        { "label": "Talk", "target": "talk_menu_text", "setFlag": "laura_first_met" },
        { "label": "Leave", "action": "close", "setFlag": "laura_first_met" }
      ]
    },
    "default_text": {
      "type": "TEXT",
      "speaker": "Laura",
      "content": "Well, hello there, darling. Looking for something shiny, or just admiring the view?",
      "next": "default_choices"
    },
    "default_choices": {
      "type": "CHOICE",
      "options": [
        { "label": "Browse Accessories", "target": "open_shop" },
        { "label": "Talk", "target": "talk_menu_text" },
        { "label": "Talk about Alicia", "target": "state_alicia_entry" },
        { "label": "Leave", "action": "close" }
      ]
    },
    "open_shop": {
       "type": "ACTION",
       "action": "OPEN_SHOP",
       "shopId": "accessories_special",
       "next": "default_choices"
    },
    "talk_menu_text": {
       "type": "TEXT",
       "content": "Go on. Say what you mean.",
       "next": "talk_menu_choices"
    },
    "talk_menu_choices": {
       "type": "CHOICE",
       "options": [
          { "label": "About Alicia", "target": "router_alicia_topic" },
          { "label": "About Raphael", "target": "talk_raphael" },
          { "label": "About the dungeon", "target": "talk_dungeon" },
          { "label": "Ask about Quest", "target": "quest_router" },
          { "label": "Back", "target": "default_text" }
       ]
    },
    "router_alicia_topic": {
      "type": "ROUTER",
      "condition": "questStatus:sparkling_gift:completed",
      "trueNode": "talk_alicia_gift",
      "falseNode": "talk_alicia_cares"
    },
    "talk_alicia_gift": {
      "type": "TEXT",
      "content": "She gave me this necklace. It’s… a bit much, isn’t it? But she looked so proud.",
      "next": "talk_alicia_gift_choices"
    },
    "talk_alicia_gift_choices": {
      "type": "CHOICE",
      "options": [
          { "label": "That’s sweet.", "target": "talk_guilty_vulnerable" },
          { "label": "Back", "target": "talk_menu_text" }
      ]
    },
    "talk_alicia_cares": {
       "type": "TEXT",
       "content": "I know. That’s the problem, isn’t it?",
       "next": "talk_alicia_cares_choices"
    },
    "talk_alicia_cares_choices": {
        "type": "CHOICE",
        "options": [
            { "label": "Do you feel guilty?", "target": "talk_guilty_router" },
            { "label": "Back", "target": "talk_menu_text" }
        ]
    },
    "talk_guilty_router": {
       "type": "ROUTER",
       "condition": "flag:laura_vulnerable_unlocked",
       "trueNode": "talk_guilty_vulnerable",
       "falseNode": "talk_guilty_deflect"
    },
    "talk_guilty_deflect": {
        "type": "TEXT",
        "content": "Guilt is for people who pretend they didn’t choose.",
        "next": "talk_guilty_deflect_choices"
    },
    "talk_guilty_deflect_choices": {
        "type": "CHOICE",
        "options": [ { "label": "Back", "target": "talk_menu_text" } ]
    },
    "talk_guilty_vulnerable": {
        "type": "TEXT",
        "content": "…Yes. Not in the dramatic way. In the quiet way that sits in your ribs when you’re alone.",
        "next": "talk_guilty_vulnerable_choices"
    },
    "talk_guilty_vulnerable_choices": {
        "type": "CHOICE",
        "options": [
            { "label": "That’s honest.", "target": "talk_guilty_honest" },
            { "label": "Back", "target": "talk_menu_text" }
        ]
    },
    "talk_guilty_honest": {
        "type": "TEXT",
        "content": "Honest doesn’t mean kind. But I’m trying.",
        "next": "talk_guilty_honest_choices"
    },
    "talk_guilty_honest_choices": {
        "type": "CHOICE",
        "options": [ { "label": "Back", "target": "talk_menu_text" } ]
    },
    "talk_raphael": {
        "type": "TEXT",
        "content": "Raphael? We’ve been engaged for seven years. He’s steady. Reliable.",
        "next": "talk_raphael_choices"
    },
    "talk_raphael_choices": {
        "type": "CHOICE",
        "options": [
            { "label": "Do you love him?", "target": "talk_love_router" },
            { "label": "Back", "target": "talk_menu_text" }
        ]
    },
    "talk_love_router": {
        "type": "ROUTER",
        "condition": "flag:laura_vulnerable_unlocked",
        "trueNode": "talk_love_vulnerable",
        "falseNode": "talk_love_deflect"
    },
    "talk_love_deflect": {
        "type": "TEXT",
        "content": "Love is a big word. We function.",
        "next": "talk_love_deflect_choices"
    },
    "talk_love_deflect_choices": {
         "type": "CHOICE",
         "options": [ { "label": "Back", "target": "talk_menu_text" } ]
    },
    "talk_love_vulnerable": {
        "type": "TEXT",
        "content": "I love the part of him that doesn’t ask questions when I go quiet.",
        "next": "talk_love_vulnerable_choices"
    },
    "talk_love_vulnerable_choices": {
         "type": "CHOICE",
         "options": [ { "label": "Back", "target": "talk_menu_text", "setFlag": "laura_vulnerable_unlocked" } ]
    },
    "talk_dungeon": {
        "type": "TEXT",
        "content": "The dungeon is a wound the town pretends is a mine.",
        "next": "talk_dungeon_choices"
    },
    "talk_dungeon_choices": {
        "type": "CHOICE",
        "options": [
            { "label": "You go down too?", "target": "talk_dungeon_go" },
            { "label": "Back", "target": "talk_menu_text" }
        ]
    },
    "talk_dungeon_go": {
        "type": "TEXT",
        "content": "Sometimes. I’m not a good Summoner. I get distracted.",
        "next": "talk_dungeon_go_choices"
    },
    "talk_dungeon_go_choices": {
         "type": "CHOICE",
         "options": [ { "label": "Back", "target": "talk_menu_text" } ]
    },
    "state_alicia_entry": {
        "type": "TEXT",
        "content": "Alicia? Oh— speak of the devil…",
        "portrait": "NPC_Laura",
        "speakers": [ { "id": "NPC_Laura", "active": true, "emotion": "neutral" } ],
        "next": "state_alicia_entry_choices"
    },
    "state_alicia_entry_choices": {
        "type": "CHOICE",
        "options": [ { "label": "...", "target": "state_alicia_hello" } ]
    },
    "state_alicia_hello": {
        "type": "TEXT",
        "content": "H-hello! I didn’t mean to interrupt!",
        "speakers": [
            { "id": "NPC_Alicia", "active": true, "emotion": "shock" },
            { "id": "NPC_Laura", "active": false, "emotion": "neutral" }
        ],
        "next": "state_alicia_hello_choices"
    },
    "state_alicia_hello_choices": {
        "type": "CHOICE",
        "options": [
            { "label": "Continue", "target": "state_alicia_reply" },
            { "label": "Step away", "action": "close" }
        ]
    },
    "state_alicia_reply": {
        "type": "TEXT",
        "content": "Just put it on the table, dear.",
        "speakers": [
            { "id": "NPC_Alicia", "active": false, "emotion": "shock" },
            { "id": "NPC_Laura", "active": true, "emotion": "approval" }
        ],
        "next": "state_alicia_reply_choices"
    },
    "state_alicia_reply_choices": {
        "type": "CHOICE",
        "options": [
            { "label": "Leave them be", "action": "close" },
            { "label": "Say something", "target": "state_player_says_something" }
        ]
    },
    "state_player_says_something": {
        "type": "TEXT",
        "content": "Oh? Do you want to mediate our domestic comedy, Summoner?",
        "speakers": [
            { "id": "NPC_Laura", "active": true, "emotion": "neutral" },
            { "id": "NPC_Alicia", "active": false, "emotion": "shock" }
        ],
        "next": "state_player_says_something_choices"
    },
    "state_player_says_something_choices": {
        "type": "CHOICE",
        "options": [
            { "label": "Be gentle to Alicia.", "target": "state_player_be_gentle" },
            { "label": "I’ll leave.", "action": "close" }
        ]
    },
    "state_player_be_gentle": {
        "type": "TEXT",
        "content": "…Fine. Alicia, come here.",
        "speakers": [
            { "id": "NPC_Laura", "active": true, "emotion": "neutral" },
            { "id": "NPC_Alicia", "active": true, "emotion": "approval" }
        ],
        "next": "state_player_be_gentle_choices"
    },
    "state_player_be_gentle_choices": {
        "type": "CHOICE",
        "options": [ { "label": "Leave quietly", "action": "close", "setFlag": "laura_vulnerable_unlocked" } ]
    },
    "quest_router": {
        "type": "ROUTER",
        "branches": [
            { "condition": "questStatus:demon_horn:completed", "target": "demon_completed_text" },
            { "condition": "questStatus:demon_horn:active", "target": "demon_active_text" },
            { "condition": "questStatus:cold_shoulder:completed", "target": "demon_check" },
            { "condition": "questStatus:cold_shoulder:active", "target": "cold_active_text" },
            { "condition": "questStatus:golden_promise:completed", "target": "cold_check" },
            { "condition": "questStatus:golden_promise:active", "target": "quest_active_text" }
        ],
        "next": "quest_offer_text"
    },
    "quest_offer_text": {
        "type": "TEXT",
        "content": "Actually, I need a favor. There’s a rare undead prowling the lower floors… an Untarnished Signet. Bring it to me.",
        "next": "quest_offer_choices"
    },
    "quest_offer_choices": {
        "type": "CHOICE",
        "options": [
            { "label": "I'll do it", "target": "action_offer_quest" },
            { "label": "Too dangerous", "target": "default_text" }
        ]
    },
    "action_offer_quest": {
        "type": "ACTION",
        "action": "OFFER_QUEST",
        "questId": "golden_promise",
        "acceptNode": "quest_active_text",
        "declineNode": "default_text"
    },
    "quest_active_text": {
        "type": "TEXT",
        "content": "If you find an Untarnished Signet, bring it straight to me.",
        "next": "quest_active_router"
    },
    "quest_active_router": {
        "type": "ROUTER",
        "condition": "hasItem:untarnished_signet",
        "trueNode": "quest_turnin_text",
        "falseNode": "quest_active_choices"
    },
    "quest_active_choices": {
        "type": "CHOICE",
        "options": [ { "label": "Back", "target": "default_text" } ]
    },
    "quest_turnin_text": {
        "type": "TEXT",
        "content": "You found it. Good.",
        "next": "quest_turnin_choices"
    },
    "quest_turnin_choices": {
        "type": "CHOICE",
        "options": [ { "label": "Give the signet", "target": "action_complete_quest" } ]
    },
    "action_complete_quest": {
        "type": "ACTION",
        "action": "COMPLETE_QUEST",
        "questId": "golden_promise",
        "completeNode": "cold_check",
        "takeItem": "untarnished_signet"
    },

    "cold_check": { "type": "ROUTER", "branches": [ { "condition": "level:7", "target": "cold_offer_text" } ], "next": "talk_menu_choices" },
    "cold_offer_text": { "type": "TEXT", "speaker": "Laura", "content": "The forge is too cold. It’s those Frost Wisps. They’re leaking chill into the air. Go break them. Five should do.", "next": "cold_offer_choices" },
    "cold_offer_choices": { "type": "CHOICE", "options": [ { "label": "Consider it done.", "target": "action_offer_cold" }, { "label": "Later.", "target": "talk_menu_text" } ] },
    "action_offer_cold": { "type": "ACTION", "action": "OFFER_QUEST", "questId": "cold_shoulder", "acceptNode": "cold_active_text", "declineNode": "talk_menu_text" },
    "cold_active_text": { "type": "TEXT", "speaker": "Laura", "content": "Kill 5 Frost Wisps.", "next": "talk_menu_choices" },

    "demon_check": { "type": "ROUTER", "branches": [ { "condition": "level:13", "target": "demon_offer_text" } ], "next": "talk_menu_choices" },
    "demon_offer_text": { "type": "TEXT", "speaker": "Laura", "content": "I need something harder than steel. Demon Horns. From the Liches in the Spire. Don't ask how a skeleton grows horns.", "next": "demon_offer_choices" },
    "demon_offer_choices": { "type": "CHOICE", "options": [ { "label": "On it.", "target": "action_offer_demon" }, { "label": "Nope.", "target": "talk_menu_text" } ] },
    "action_offer_demon": { "type": "ACTION", "action": "OFFER_QUEST", "questId": "demon_horn", "acceptNode": "demon_active_text", "declineNode": "talk_menu_text" },
    "demon_active_text": { "type": "TEXT", "speaker": "Laura", "content": "Bring me 3 Demon Horns.", "next": "demon_turnin_check" },
    "demon_turnin_check": { "type": "ROUTER", "condition": "hasItem:demon_horn", "trueNode": "demon_turnin_text", "falseNode": "talk_menu_choices" },
    "demon_turnin_text": { "type": "TEXT", "speaker": "Laura", "content": "Excellent. These will make a fine shield. Here.", "next": "demon_turnin_choices" },
    "demon_turnin_choices": { "type": "CHOICE", "options": [ { "label": "Take shield.", "target": "action_complete_demon" } ] },
    "action_complete_demon": { "type": "ACTION", "action": "COMPLETE_QUEST", "questId": "demon_horn", "completeNode": "demon_completed_text", "takeItem": "demon_horn" },
    "demon_completed_text": { "type": "TEXT", "speaker": "Laura", "content": "A good day's work. Rare for this town.", "next": "talk_menu_choices" }
  }
}
