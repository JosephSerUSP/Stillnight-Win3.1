{
  "id": "npc_laura",
  "name": "Laura",
  "layout": "visual_novel",
  "portrait": "NPC_Laura",
  "initialNode": "root_router",
  "nodes": {
    "root_router": {
      "type": "ROUTER",
      "branches": [
         { "condition": "questStatus:lost_ring:active", "target": "quest_lost_ring_router" },
         { "condition": "questStatus:golden_promise:completed", "target": "quest_promise_router_complete" },
         { "condition": "questStatus:golden_promise:active", "target": "quest_promise_router" },
         { "condition": "flag:laura_first_met", "target": "talk_menu_text" }
      ],
      "next": "intro_text"
    },
    "intro_text": {
      "type": "TEXT",
      "speaker": "Laura",
      "content": "Hey. You're the new summoner, right? Try not to die down there. Alicia cries easily, and I hate cleaning up tears.",
      "next": "intro_choices"
    },
    "intro_choices": {
      "type": "CHOICE",
      "options": [
        { "label": "I'll be careful.", "target": "intro_careful", "setFlag": "laura_first_met" },
        { "label": "Who are you?", "target": "talk_self", "setFlag": "laura_first_met" },
        { "label": "Leave", "action": "close", "setFlag": "laura_first_met" }
      ]
    },
    "intro_careful": {
       "type": "TEXT",
       "speaker": "Laura",
       "content": "Good. We need people who stick around. The graveyard is full enough.",
       "next": "talk_menu_choices"
    },
    "talk_menu_text": {
       "type": "TEXT",
       "speaker": "Laura",
       "content": "So? Need something forged, or just staring?",
       "next": "talk_menu_choices"
    },
    "talk_menu_choices": {
      "type": "CHOICE",
      "options": [
        { "label": "Ask about Quest", "target": "quest_router" },
        { "label": "About Alicia", "target": "talk_alicia" },
        { "label": "About Raphael", "target": "talk_raphael" },
        { "label": "About You", "target": "talk_self" },
        { "label": "Leave", "action": "close" }
      ]
    },
    "talk_alicia": {
      "type": "TEXT",
      "speaker": "Laura",
      "content": "She's... a handful. But she means well. If you ever hurt her, I'll melt you down into ingots. Clear?",
      "next": "talk_menu_choices"
    },
    "talk_raphael": {
      "type": "TEXT",
      "speaker": "Laura",
      "content": "He's my fianc√©. He's out on a delve right now. He's... pragmatic. Unlike Alicia. He knows what needs to be done.",
      "next": "talk_raphael_2"
    },
    "talk_raphael_2": {
       "type": "TEXT",
       "speaker": "Laura",
       "content": "We've been together seven years. It's stable. Solid. Like good steel.",
       "next": "talk_menu_choices"
    },
    "talk_self": {
      "type": "TEXT",
      "speaker": "Laura",
      "content": "I'm a goldsmith. And a summoner, when I have to be. I prefer metal. It doesn't bleed, and it doesn't scream.",
      "next": "talk_menu_choices"
    },
    "quest_router": {
      "type": "ROUTER",
      "branches": [
        { "condition": "questStatus:golden_promise:completed", "target": "quest_promise_completed_text" },
        { "condition": "questStatus:golden_promise:active", "target": "quest_promise_router" }
      ],
      "next": "quest_offer_promise"
    },
    "quest_offer_promise": {
      "type": "TEXT",
      "speaker": "Laura",
      "content": "I'm working on a piece. A ring. But I need gold that's... seen death. An 'Untarnished Signet' from the undead in the crypts. Get it for me?",
      "next": "quest_promise_choices"
    },
    "quest_promise_choices": {
      "type": "CHOICE",
      "options": [
        { "label": "Sure.", "target": "action_offer_promise" },
        { "label": "Not now.", "target": "talk_menu_text" }
      ]
    },
    "action_offer_promise": {
      "type": "ACTION",
      "action": "OFFER_QUEST",
      "questId": "golden_promise",
      "acceptNode": "quest_promise_active_text",
      "declineNode": "talk_menu_text"
    },
    "quest_promise_router": {
      "type": "ROUTER",
      "condition": "hasItem:untarnished_signet",
      "trueNode": "quest_promise_turnin_text",
      "falseNode": "quest_promise_active_text"
    },
    "quest_promise_active_text": {
      "type": "TEXT",
      "speaker": "Laura",
      "content": "The ring. Don't come back without it. It needs to be perfect.",
      "next": "talk_menu_choices"
    },
    "quest_promise_turnin_text": {
      "type": "TEXT",
      "speaker": "Laura",
      "content": "Let me see. ...Yes. The energy in this gold is cold. Perfect for tempering. You did good. Here.",
      "next": "quest_promise_turnin_choices"
    },
    "quest_promise_turnin_choices": {
      "type": "CHOICE",
      "options": [
        { "label": "Take reward.", "target": "action_complete_promise" }
      ]
    },
    "action_complete_promise": {
      "type": "ACTION",
      "action": "COMPLETE_QUEST",
      "questId": "golden_promise",
      "completeNode": "quest_promise_completed_text",
      "takeItem": "untarnished_signet"
    },
    "quest_promise_completed_text": {
      "type": "TEXT",
      "speaker": "Laura",
      "content": "Raphael will like this. It's... durable. Like us.",
      "next": "talk_menu_choices"
    },
    "quest_promise_router_complete": {
       "type": "ROUTER",
       "condition": "flag:laura_lost_ring_seen",
       "trueNode": "quest_lost_ring_completed_check",
       "falseNode": "quest_offer_lost_ring"
    },
    "quest_offer_lost_ring": {
       "type": "TEXT",
       "speaker": "Laura",
       "content": "Damn it. Damn it all! ...Hey. I messed up. I went down to test the ring's resonance, and... I dropped it. Floor 4. It's gone.",
       "next": "quest_offer_lost_ring_choices"
    },
    "quest_offer_lost_ring_choices": {
      "type": "CHOICE",
      "options": [
        { "label": "I'll find it for you.", "target": "action_offer_lost_ring" },
        { "label": "That sucks.", "target": "talk_menu_text" }
      ]
    },
    "action_offer_lost_ring": {
       "type": "ACTION",
       "action": "OFFER_QUEST",
       "questId": "lost_ring",
       "acceptNode": "quest_lost_ring_active_text",
       "declineNode": "talk_menu_text"
    },
    "quest_lost_ring_router": {
       "type": "ROUTER",
       "condition": "hasItem:lost_ring",
       "trueNode": "quest_lost_ring_turnin_text",
       "falseNode": "quest_lost_ring_active_text"
    },
    "quest_lost_ring_active_text": {
       "type": "TEXT",
       "speaker": "Laura",
       "content": "It's on Floor 4. Somewhere near the Cryptic Vaults. Please. I can't tell Raphael I lost it.",
       "next": "talk_menu_choices"
    },
    "quest_lost_ring_turnin_text": {
       "type": "TEXT",
       "speaker": "Laura",
       "content": "You... you actually found it. I thought it was gone forever. ...Thanks. Seriously. I owe you.",
       "next": "quest_lost_ring_turnin_choices"
    },
    "quest_lost_ring_turnin_choices": {
       "type": "CHOICE",
       "options": [
         { "label": "You're welcome.", "target": "action_complete_lost_ring" }
       ]
    },
    "action_complete_lost_ring": {
       "type": "ACTION",
       "action": "COMPLETE_QUEST",
       "questId": "lost_ring",
       "completeNode": "quest_lost_ring_completed_text",
       "takeItem": "lost_ring"
    },
    "quest_lost_ring_completed_text": {
       "type": "TEXT",
       "speaker": "Laura",
       "content": "I'm keeping this on a chain around my neck from now on. No more testing in the dungeon.",
       "next": "talk_menu_choices"
    },
    "quest_lost_ring_completed_check": {
       "type": "ROUTER",
       "condition": "questStatus:lost_ring:completed",
       "trueNode": "quest_lost_ring_completed_text",
       "falseNode": "quest_offer_lost_ring"
    }
  }
}
