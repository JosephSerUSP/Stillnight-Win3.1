{
  "id": "npc_alicia",
  "name": "Alicia",
  "layout": "visual_novel",
  "portrait": "NPC_Alicia",
  "initialNode": "root_router",
  "nodes": {
    "root_router": {
      "type": "ROUTER",
      "branches": [
         { "condition": "questStatus:silent_shipment:active", "target": "quest_shipment_router" },
         { "condition": "flag:alicia_first_met", "target": "default_hub_text" }
      ],
      "next": "intro_text"
    },

    "quest_shipment_router": {
      "type": "ROUTER",
      "condition": "flag:shipment_investigated",
      "trueNode": "default_hub_text",
      "falseNode": "quest_shipment_text"
    },

    "quest_shipment_text": {
      "type": "TEXT",
      "speaker": "Alicia",
      "content": "Oh! Are you looking for the supply cart? I heard it! I was listening to the wind near the chasm, and I heard squeaky wheels stop suddenly. Then... goblin noises. Lots of them.",
      "next": "quest_shipment_choices"
    },
    "quest_shipment_choices": {
      "type": "CHOICE",
      "options": [
        { "label": "Goblins? I should tell the guard.", "target": "quest_shipment_resolve", "setFlag": "shipment_investigated" }
      ]
    },
    "quest_shipment_resolve": {
      "type": "TEXT",
      "speaker": "Alicia",
      "content": "Please be careful! If the goblins have the food, they'll be... energetic.",
      "next": "default_hub_text"
    },

    "intro_text": {
      "type": "TEXT",
      "speaker": "Alicia",
      "content": "Oh! H-hello—! I… I didn’t see you coming. I’m Alicia. Welcome to my shop! Uhm— please look around! And— and if you’re hungry, I can warm something up. Not for sale. Just… because.",
      "next": "intro_choices"
    },
    "intro_choices": {
      "type": "CHOICE",
      "options": [
        { "label": "Buy Consumables", "target": "shop_consumables", "setFlag": "alicia_first_met" },
        { "label": "You’re kind.", "target": "intro_kind_text" },
        { "label": "Leave", "action": "close", "setFlag": "alicia_first_met" }
      ]
    },
    "intro_kind_text": {
      "type": "TEXT",
      "speaker": "Alicia",
      "content": "M-me? No, I’m… I’m normal. I just… I don’t like when people look empty. Like they forgot they have a body. Sorry. That sounded weird.",
      "next": "intro_kind_choices"
    },
    "intro_kind_choices": {
      "type": "CHOICE",
      "options": [
        { "label": "Not weird.", "target": "intro_not_weird_text" },
        { "label": "Buy Consumables", "target": "shop_consumables", "setFlag": "alicia_first_met" },
        { "label": "Leave", "action": "close", "setFlag": "alicia_first_met" }
      ]
    },
    "intro_not_weird_text": {
      "type": "TEXT",
      "speaker": "Alicia",
      "content": "…Thank you. People usually laugh. Or they say ‘that’s cute’ and then they don’t mean it. Anyway! Please— uhm— browse!",
      "next": "intro_not_weird_choices"
    },
    "intro_not_weird_choices": {
      "type": "CHOICE",
      "options": [
        { "label": "Buy Consumables", "target": "shop_consumables", "setFlag": "alicia_first_met" },
        { "label": "Talk", "target": "talk_menu_text", "setFlag": "alicia_first_met" },
        { "label": "Leave", "action": "close", "setFlag": "alicia_first_met" }
      ]
    },
    "default_hub_text": {
      "type": "TEXT",
      "speaker": "Alicia",
      "content": "Oh! H-hello there! I… I didn’t see you coming! Uhm… welcome! Please look around. And— uh— drink water. People forget.",
      "next": "default_hub_choices"
    },
    "default_hub_choices": {
      "type": "CHOICE",
      "options": [
        { "label": "Buy Consumables", "target": "shop_consumables" },
        { "label": "Talk", "target": "talk_menu_text" },
        { "label": "Leave", "action": "close" }
      ]
    },
    "shop_consumables": {
      "type": "ACTION",
      "action": "OPEN_SHOP",
      "shopId": "consumables_basic",
      "next": "default_hub_choices"
    },
    "talk_menu_text": {
      "type": "TEXT",
      "speaker": "Alicia",
      "content": "O-okay. What do you want to talk about? I’m not good at… normal conversations.",
      "next": "talk_menu_choices"
    },
    "talk_menu_choices": {
      "type": "CHOICE",
      "options": [
        { "label": "About Laura", "target": "talk_laura" },
        { "label": "About Shop", "target": "talk_shop" },
        { "label": "About You", "target": "talk_self" },
        { "label": "Ask about Quest", "target": "quest_router" },
        { "label": "Back", "target": "default_hub_text" }
      ]
    },
    "talk_laura": {
      "type": "TEXT",
      "speaker": "Alicia",
      "content": "Laura? She’s… she’s amazing. She’s strong, and beautiful, and… and she smells like vanilla and iron. Is that weird? That’s weird. Forget I said that.",
      "next": "talk_menu_choices"
    },
    "talk_shop": {
      "type": "TEXT",
      "speaker": "Alicia",
      "content": "I sell things that keep you alive! It makes me happy. Watching people leave with full bags… it means they might come back. That’s nice.",
      "next": "talk_menu_choices"
    },
    "talk_self": {
      "type": "TEXT",
      "speaker": "Alicia",
      "content": "Me? I’m just Alicia. I like baking. And… I like listening to the rain. The dungeon is scary, but the rain makes it sound like it’s sleeping.",
      "next": "talk_menu_choices"
    },
    "quest_router": {
      "type": "ROUTER",
      "branches": [
        { "condition": "questStatus:new_dawn:completed", "target": "dawn_completed_text" },
        { "condition": "questStatus:new_dawn:active", "target": "dawn_active_text" },
        { "condition": "questStatus:true_warden:completed", "target": "dawn_check" },
        { "condition": "questStatus:angelic_feather:completed", "target": "angel_completed_text" },
        { "condition": "questStatus:angelic_feather:active", "target": "angel_active_text" },
        { "condition": "questStatus:frozen_hearts:completed", "target": "angel_check" },
        { "condition": "questStatus:frozen_hearts:active", "target": "frozen_active_text" },
        { "condition": "questStatus:sparkling_gift:completed", "target": "frozen_check" },
        { "condition": "questStatus:sparkling_gift:active", "target": "sparkling_active_text" }
      ],
      "next": "sparkling_offer_text"
    },

    "sparkling_offer_text": {
      "type": "TEXT",
      "speaker": "Alicia",
      "content": "Actually… can I ask a favor? It’s about Laura. I want to give her something special. A 'Glittering Teardrop'. Would you...?",
      "next": "sparkling_offer_choices"
    },
    "sparkling_offer_choices": {
      "type": "CHOICE",
      "options": [
        { "label": "I'll find it.", "target": "action_offer_sparkling" },
        { "label": "Later.", "target": "talk_menu_text" }
      ]
    },
    "action_offer_sparkling": { "type": "ACTION", "action": "OFFER_QUEST", "questId": "sparkling_gift", "acceptNode": "sparkling_active_text", "declineNode": "talk_menu_text" },
    "sparkling_active_text": { "type": "TEXT", "speaker": "Alicia", "content": "Please be careful looking for the Teardrop.", "next": "sparkling_turnin_check" },
    "sparkling_turnin_check": { "type": "ROUTER", "condition": "hasItem:glittering_teardrop", "trueNode": "sparkling_turnin_text", "falseNode": "talk_menu_choices" },
    "sparkling_turnin_text": { "type": "TEXT", "speaker": "Alicia", "content": "You found it! It's perfect! Thank you!", "next": "sparkling_turnin_choices" },
    "sparkling_turnin_choices": { "type": "CHOICE", "options": [ { "label": "Here you go.", "target": "action_complete_sparkling" } ] },
    "action_complete_sparkling": { "type": "ACTION", "action": "COMPLETE_QUEST", "questId": "sparkling_gift", "completeNode": "frozen_check", "takeItem": "glittering_teardrop" },

    "frozen_check": { "type": "ROUTER", "branches": [ { "condition": "level:7", "target": "frozen_offer_text" } ], "next": "talk_menu_choices" },
    "frozen_offer_text": { "type": "TEXT", "speaker": "Alicia", "content": "The dungeon... it feels so cold lately. Like a freezer left open. I need to study it. Could you bring me Frozen Cores?", "next": "frozen_offer_choices" },
    "frozen_offer_choices": { "type": "CHOICE", "options": [ { "label": "I'll help.", "target": "action_offer_frozen" }, { "label": "No time.", "target": "talk_menu_text" } ] },
    "action_offer_frozen": { "type": "ACTION", "action": "OFFER_QUEST", "questId": "frozen_hearts", "acceptNode": "frozen_active_text", "declineNode": "talk_menu_text" },
    "frozen_active_text": { "type": "TEXT", "speaker": "Alicia", "content": "Be careful of the frost. It bites.", "next": "frozen_turnin_check" },
    "frozen_turnin_check": { "type": "ROUTER", "condition": "hasItem:frozen_core", "trueNode": "frozen_turnin_text", "falseNode": "talk_menu_choices" },
    "frozen_turnin_text": { "type": "TEXT", "speaker": "Alicia", "content": "These... they hurt to hold. But they explain so much. Thank you.", "next": "frozen_turnin_choices" },
    "frozen_turnin_choices": { "type": "CHOICE", "options": [ { "label": "Take them.", "target": "action_complete_frozen" } ] },
    "action_complete_frozen": { "type": "ACTION", "action": "COMPLETE_QUEST", "questId": "frozen_hearts", "completeNode": "angel_check", "takeItem": "frozen_core" },

    "angel_check": { "type": "ROUTER", "branches": [ { "condition": "level:13", "target": "angel_offer_text" } ], "next": "talk_menu_choices" },
    "angel_offer_text": { "type": "TEXT", "speaker": "Alicia", "content": "Do you feel it? The Spire... it feels like a church, but... scary. Can you bring me Angel Feathers? I want to see if they're real.", "next": "angel_offer_choices" },
    "angel_offer_choices": { "type": "CHOICE", "options": [ { "label": "I will.", "target": "action_offer_angel" }, { "label": "Later.", "target": "talk_menu_text" } ] },
    "action_offer_angel": { "type": "ACTION", "action": "OFFER_QUEST", "questId": "angelic_feather", "acceptNode": "angel_active_text", "declineNode": "talk_menu_text" },
    "angel_active_text": { "type": "TEXT", "speaker": "Alicia", "content": "Angels are supposed to be nice. Why are these so mean?", "next": "angel_turnin_check" },
    "angel_turnin_check": { "type": "ROUTER", "condition": "hasItem:angel_feather", "trueNode": "angel_turnin_text", "falseNode": "talk_menu_choices" },
    "angel_turnin_text": { "type": "TEXT", "speaker": "Alicia", "content": "They're so soft... but they smell like ozone. Strange.", "next": "angel_turnin_choices" },
    "angel_turnin_choices": { "type": "CHOICE", "options": [ { "label": "Here.", "target": "action_complete_angel" } ] },
    "action_complete_angel": { "type": "ACTION", "action": "COMPLETE_QUEST", "questId": "angelic_feather", "completeNode": "angel_completed_text", "takeItem": "angel_feather" },
    "angel_completed_text": { "type": "TEXT", "speaker": "Alicia", "content": "Thank you for these feathers. I'll keep them safe.", "next": "talk_menu_choices" },

    "dawn_check": { "type": "ROUTER", "branches": [ { "condition": "questStatus:true_warden:completed", "target": "dawn_offer_text" } ], "next": "talk_menu_choices" },
    "dawn_offer_text": { "type": "TEXT", "speaker": "Alicia", "content": "You did it! The Spire is quiet! We should celebrate! Talk to everyone!", "next": "dawn_offer_choices" },
    "dawn_offer_choices": { "type": "CHOICE", "options": [ { "label": "Let's party.", "target": "action_offer_dawn" } ] },
    "action_offer_dawn": { "type": "ACTION", "action": "OFFER_QUEST", "questId": "new_dawn", "acceptNode": "dawn_active_text", "declineNode": "talk_menu_text" },
    "dawn_active_text": { "type": "TEXT", "speaker": "Alicia", "content": "Go talk to Laura and Geraldo! Tell them we're safe!", "next": "talk_menu_choices" },
    "dawn_completed_text": { "type": "TEXT", "speaker": "Alicia", "content": "This is the best day ever!", "next": "talk_menu_choices" }
  }
}
