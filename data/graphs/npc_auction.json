{
  "id": "npc_auction",
  "name": "Auctioneer",
  "layout": "visual_novel",
  "initialNode": "root_router",
  "nodes": {
    "root_router": {
      "type": "ROUTER",
      "branches": [
        { "condition": "questStatus:auction_prize:completed", "target": "quest_complete_text" },
        { "condition": "questStatus:auction_prize:active", "target": "quest_active_check" }
      ],
      "next": "default_text"
    },

    "default_text": {
      "type": "TEXT",
      "content": "Rare finds! Highest bidder takes all! …Well. Fixed price for now. But the *spirit* is the same. Spend like you’re trying to forget something.",
      "next": "default_choices"
    },
    "default_choices": {
      "type": "CHOICE",
      "options": [
        { "label": "Browse", "target": "open_shop" },
        { "label": "Ask what’s ‘unidentified’ mean", "target": "talk_unid_text" },
        { "label": "Looking for something?", "target": "quest_offer", "condition": "questStatus:auction_prize:inactive" },
        { "label": "Leave", "action": "close" }
      ]
    },

    "quest_offer": {
        "type": "TEXT",
        "content": "A client of mine has a peculiar taste. They want an 'Ancient Idol' from the Heart of Entropy. Floor 13. Ugly thing. Cursed, probably. But the pay is... astronomical.",
        "next": "quest_offer_choices"
    },
    "quest_offer_choices": {
        "type": "CHOICE",
        "options": [
            { "label": "I'll fetch it.", "target": "action_offer_quest" },
            { "label": "I don't touch cursed things.", "target": "default_choices" }
        ]
    },
    "action_offer_quest": {
        "type": "ACTION",
        "action": "OFFER_QUEST",
        "questId": "auction_prize",
        "acceptNode": "quest_reminder",
        "declineNode": "default_choices"
    },
    "quest_active_check": {
        "type": "ROUTER",
        "condition": "hasItem:ancient_idol",
        "trueNode": "quest_turnin",
        "falseNode": "quest_reminder"
    },
    "quest_reminder": {
        "type": "TEXT",
        "content": "The Idol! Floor 13. Tick tock! The client is impatient.",
        "next": "default_choices"
    },
    "quest_turnin": {
        "type": "TEXT",
        "content": "You have it! Don't look at its eyes. Just... put it in the box. Quickly. Marvelous!",
        "next": "quest_complete_action"
    },
    "quest_complete_action": {
        "type": "ACTION",
        "action": "COMPLETE_QUEST",
        "questId": "auction_prize",
        "completeNode": "quest_complete_text",
        "takeItem": "ancient_idol"
    },
    "quest_complete_text": {
        "type": "TEXT",
        "content": "Here is your payment. Don't ask where it came from. Enjoy the bidding!",
        "next": "default_choices"
    },

    "open_shop": {
      "type": "ACTION",
      "action": "OPEN_SHOP",
      "shopId": "auction_house",
      "next": "default_choices"
    },
    "talk_unid_text": {
      "type": "TEXT",
      "content": "It means you pay first and ask questions later. Just like love. Just like the dungeon. Now— are you brave, or are you smart?",
      "next": "talk_unid_choices"
    },
    "talk_unid_choices": {
      "type": "CHOICE",
      "options": [
        { "label": "Browse", "target": "open_shop" },
        { "label": "Back", "target": "default_text" }
      ]
    }
  }
}
